---
layout: post
title:  "노드 심플 서버 제작"
date:   2019-12-12 02:23
author: 꾸
categories: node.js
tags:	NodeJS
cover:  "/assets/nodejs.png"
---

# NodeJS 간단한 서버 만들기
[Node설치](#NodeJs-설치)\
[Node설치확인](#Node-설치-확인)\
[Node사용](#Node-간단한-사용)

## Node 설치
노드 다운로드 https://nodejs.org/ko/

OS : windosws 10 pro\
노드 버전 : 12.13.1 LTS

## Node 설치 확인
>윈도우키를 누른 후 cmd 입력  or 시작 (명령프롬프트) 실행
```sh
user> node -v 
v12.13.1
```
>npm 버전업 하기 (선택사항)
```sh
# 설치 후 파일을 node 가 설치된 곳에 넣어준다.
위치> npm install npm@latest
```
>yarn 설치 (추후 패키지 다운로드시 npm 속도가 느리다.)
```sh
#윈도우 전역에서 사용 가능하도록 글로벌 설치
user> npm install -g yarn
user> yarn -v
1.21.0 # 버전은 다를 수 있다.
```

## node 간단한 사용
>폴더생성 > index.js 파일 생성 > 아래 자바스크립트 코드 입력
```js
console.log("안녕하세요 node 입니다.");
```
>폴더 안에서  shift + 우클릭 > 여기에 PowerShell 창 열기 클릭
```sh
# PowerShell 창 (터미널)
user> node index.js
안녕하세요 node 입니다. # 출력 console.log (내용)
user>
```

## koa 설치
>Node Express 팀의 새로운 웹 프레임워크 -> <a href='https://koajs.com/#introduction'>KOA 사이트</a><br/>
큰장점 -> async/await 을 지원 Express 와는 달리 callback 에서 자유롭다.
```js
/* 사용법은 나중에 알게 된다. */
app.use(async (ctx, next) => {
    console.log(1);
    const started = new Date();
    await next();
    console.log(new Date() - started + 'ms');
});
```

### 여기서 잠깐 async/await ?
>callback hell..  promise hell.. 탈출<br/>
이를 해결하기 위해서 async await 이 ES7에 등장.. (익스플로러버전이 낮으면 사용 불가..)<br/>
async 함수 내부에서 await 을 사용할 수 있다.

```js
function asyncFunction1()
{
   return new Promise(function (resolve)
   {
      setTimeout(function()
      {
         resolve(111);
      }, 300);
   })
}

async function async1()
{
   const result = await asyncFunction1();
   // await 키워드로 다른 promise를 반환하는 함수의 실행 결과값을 변수에 담을 수 있습니다.
   console.log(result); // 111
}
asyncFunction1();
async1();

async function async2()
{
   let result 
   try
   {
      result = await asyncFunction1()
   }
   catch (error) // await 에서 발상한 에러는 모드 아래 catch 블록 들어간다.
   {
      console.log(error);
   }
   if (result === 'AAA') // if 문 분기도 일반 동기함수처럼 작성 가능하다.
   {
      doSometing();
   }
   return result;
}
async2() // 에러가 없어서 catch 출력이 없다.

// 출력 
111
```
>async 함수 내부에선 await 을 사용해 마치 동기적으로 코드를 작성할 수 있다.<br/>
에러 핸들링과 if문 분기 또한 동기적으로 작성가능하며 프로미스와 다르게 에러 스택 추적도 용이하다. <br/>
주의할 점은 최종 async 함수의 반환값은 항상 promise 객체라는 것 !